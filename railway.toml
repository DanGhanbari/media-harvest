[build]
# Build command for Railway deployment
# Install Python, pip, and yt-dlp, then build the Node.js app
command = "apt-get update && apt-get install -y python3 python3-pip && pip3 install yt-dlp && node --version && npm --version && npm install --no-frozen-lockfile && npm run build"

[deploy]
# Start command for Railway deployment
startCommand = "node server.js"
# Restart policy
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment variables
[env]
NODE_ENV = "production"
# PORT is automatically set by Railway

# Health check configuration
[healthcheck]
path = "/api/health"
interval = 30
timeout = 10
retries = 3

# Resource allocation
[resources]
memory = 1024  # 1GB RAM
cpu = 1000     # 1 vCPU

# Auto-scaling configuration
[autoscaling]
minReplicas = 1
maxReplicas = 3
targetCPU = 80
targetMemory = 80